# Test Scenarios - API

Detailed description of API test scenarios for ReqRes API.

# Overview

Testing the ReqRes REST API (https://reqres.in/api). All 6 tests pass.

The API is a mock API which means it doesn't save real data, but returns realistic HTTP responses.

# Scenario 1: List of users with odd IDs

ID: TC-API-001
Tag: @api @scenario1
Method: GET
Endpoint: /users?page=1
Status: Passes

### Description

Sends GET request for first page of users, filters those with odd IDs and prints them.

### Request

http
GET /users?page=1
Host: reqres.in
Content-Type: application/json
X-API-Key: reqres-free-v1

Query parameter:

- page=1 - first page of results

### Expected Response

Status: 200 OK

Body:

json
{
"page": 1,
"per_page": 6,
"total": 12,
"data": [
{
"id": 1,
"email": "george.bluth@reqres.in",
"first_name": "George",
"last_name": "Bluth"
},
...
]
}

### Validation

1. Status code = 200
2. Response contains data array
3. Filter users where id % 2 === 1
4. Print filtered users

### Implementation

Gherkin scenario from `API_tests/features/user_management.feature`:

```gherkin
@scenario1 @get-users
Scenario: Get list of users and display odd IDs
  When Send GET request to "/users?page=1"
  Then Response status should be 200
  And Users with odd IDs should be displayed
```

Step definition in `API_tests/steps/ApiSteps.ts` filters and displays odd IDs.

### Expected output

Users with odd IDs:
ID: 1, name: George Bluth
ID: 3, name: Emma Wong
ID: 5, name: Charles Morris

## Scenario 2: Create new user

ID: TC-API-002  
Tag: @api @scenario2  
Method: POST  
Endpoint: /users  
Status: Passes

### Description

Creates a new user and checks that the creation date is today.

### Request

http
POST /users
Content-Type: application/json
X-API-Key: reqres-free-v1

{
"name": "Hristina",
"job": "QA Engineer"
}

### Expected Response

Status: 201 Created

Body:

json
{
"name": "Hristina",
"job": "QA Engineer",
"id": "123",
"createdAt": "2025-11-16T12:34:56.789Z"
}

### Validation

1. Status code = 201
2. name matches sent data
3. job matches sent data
4. id exists (generated by API)
5. createdAt timestamp is today's date

### Implementation

Gherkin scenario from `API_tests/features/user_management.feature`:

```gherkin
@scenario2 @create-user
Scenario: Create new user and validate creation date
  Given User data with name "Hristina" and job "QA Engineer" is prepared
  When Send POST request to "/users" with payload
  Then Response status should be 201
  And Response should contain user name "Hristina"
  And Response should contain user job "QA Engineer"
  And Creation date should be today
```

## Scenario 3: Update user

ID: TC-API-003  
Tag: @api @scenario3  
Method: PUT  
Endpoint: /users/2  
Status: Passes

### Description

Updates existing user (ID=2) and checks response.

### Request

http
PUT /users/2
Content-Type: application/json
X-API-Key: reqres-free-v1

{
"name": "Hristina",
"job": "Senior QA"
}

### Expected Response

Status: 200 OK

Body:

json
{
"name": "Hristina",
"job": "Senior QA",
"updatedAt": "2025-11-16T12:34:56.789Z"
}

### Validation

1. Status code = 200
2. Response body matches request body
3. updatedAt timestamp exists

### Note

ReqRes is a mock API, PUT request doesn't change real data but returns expected response format.

## Scenario 4: Response time without delay

ID: TC-API-004  
Tag: @api @scenario4  
Method: GET  
Endpoint: /users?delay=0  
Status: Passes

### Description

Checks that API responds in less than 1 second when there's no artificial delay.

### Request

http
GET /users?delay=0

Query parameter:

- delay=0 - no simulated delay

### Validation

1. Status code = 200
2. Response time â‰¤ 1000ms

### Implementation

Gherkin scenario from `API_tests/features/user_management.feature`:

```gherkin
@scenario4 @response-time @fast
Scenario: Validate fast response time with no delay
  When Send GET request to "/users?delay=0"
  Then Response status should be 200
  And Response time should be less than 1000 ms
```

### Typical time

~150-300ms (depends on network)

## Scenario 4b: Response time with 3s delay

ID: TC-API-004b  
Tag: @api @scenario4b  
Method: GET  
Endpoint: /users?delay=3  
Status: Passes

### Description

Checks that API respects artificial delay parameter.

### Request

http
GET /users?delay=3

Query parameter:

- delay=3 - 3 second delay

### Validation

1. Status code = 200
2. Response time between 3000-4000ms

Range 3000-4000ms covers:

- Intentional 3s delay
- Network latency
- Server/client overhead

### Implementation

Gherkin scenario from `API_tests/features/user_management.feature`:

```gherkin
@scenario4 @response-time @slow
Scenario: Validate response time with 3 second delay
  When Send GET request to "/users?delay=3"
  Then Response status should be 200
  And Response time should be between 3000 and 4000 ms
```

### Typical time

~3100-3200ms

## Scenario 5: Login without password

ID: TC-API-005  
Tag: @api @scenario5  
Method: POST  
Endpoint: /login  
Status: Passes

### Description

Negative test - checks validation when password is missing.

### Request

http
POST /login
Content-Type: application/json
X-API-Key: reqres-free-v1

{
"email": "peter@klaven"
}

Intentionally omitted password field.

### Expected Response

Status: 400 Bad Request

Body:

json
{
"error": "Missing password"
}

### Validation

1. Status code = 400
2. Response contains error field
3. Error message = "Missing password"

### Implementation

Gherkin scenario from `API_tests/features/user_management.feature`:

```gherkin
@scenario5 @negative @login-error
Scenario: Login without password should fail
  Given Login payload with email "peter@klaven" but no password is prepared
  When Send POST request to "/login" with payload
  Then Response status should be 400
  And Response error should be "Missing password"
```

### Security check

This verifies that the API properly validates input and doesn't allow login without all required fields.

## Statistics

### Overall

- Scenarios: 6
- Passed: 6
- Failed: 0
- Pass rate: 100%
- Average response time: ~200-500ms (without delay)

### By request type

| Method | Tests | Status   |
| ------ | ----- | -------- |
| GET    | 3     | All pass |
| POST   | 2     | All pass |
| PUT    | 1     | Passes   |

### By test type

| Type        | Tests | Status    |
| ----------- | ----- | --------- |
| Positive    | 5     | All pass  |
| Negative    | 1     | Passes    |
| Performance | 2     | Both pass |

## API Configuration

In codecept.conf.ts:

typescript
REST: {
endpoint: 'https://reqres.in/api',
onRequest: (request) => {
request.headers = {
'Content-Type': 'application/json',
'X-API-Key': 'reqres-free-v1',
};
},
}

API key is automatically added to every request.

## Available Methods

REST helper methods:

typescript
I.sendGetRequest(url, headers?)
I.sendPostRequest(url, payload, headers?)
I.sendPutRequest(url, payload, headers?)
I.sendDeleteRequest(url, headers?)
I.sendPatchRequest(url, payload, headers?)

Response object:

typescript
{
status: number, // HTTP status code
data: any, // Response body (parsed JSON)
headers: object // Response headers
}

Custom assertions:

typescript
I.assertEqual(expected, actual, message?)
I.assertDeepEqual(obj1, obj2, message?)
I.assert(condition, message)
I.say(message) // console output

### Mock API limitations

ReqRes is a mock API for testing:

- POST/PUT/DELETE requests don't change real data
- Always returns same set of test users
- IDs in responses are generated but not consistent
- No rate limiting

Tests validate:

- HTTP status codes
- Response structure
- Data format
- Timing

Don't validate:

- Data persistence (because it's mock)
- Complex business logic

### Response time variation

Response time can vary due to:

- Network latency
- Server load
- Geographic distance
- Internet connection

That's why we use ranges (e.g. 3000-4000ms) instead of exact values.

For more information see README_API.md.
